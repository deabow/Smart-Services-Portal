{% extends 'base.html' %}

{% block title %}طلب استعادة كلمة المرور - خدمة المواطنين{% endblock %}

{% block page_indicator %}
<div class="page-indicator">
	<i class="fas fa-key"></i> طلب استعادة كلمة المرور - الموقع الرسمي للنائب احمد ابوزيد
</div>
{% endblock %}

{% block content %}
<div class="row justify-content-center">
	<div class="col-md-8 col-lg-6">
		<div class="card border-0 shadow-sm">
			<div class="card-body p-5">
				<div class="text-center mb-4">
					<div class="bg-warning bg-opacity-10 rounded-circle d-inline-flex align-items-center justify-content-center mb-3" 
						 style="width: 80px; height: 80px;">
						<i class="fas fa-key text-warning" style="font-size: 2rem; color: #f59e0b !important;"></i>
					</div>
					<h3 class="card-title" style="color: #1e40af;">طلب استعادة كلمة المرور</h3>
					<p class="text-muted">أدخل بياناتك للتحقق من هويتك وسيتم مراجعة طلبك من قبل الإدارة</p>
				</div>

				{% if messages %}
					{% for message in messages %}
						<div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
							<i class="fas fa-{% if message.tags == 'success' %}check-circle{% elif message.tags == 'warning' %}exclamation-triangle{% else %}info-circle{% endif %} me-2"></i>
							{{ message }}
							<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
						</div>
					{% endfor %}
				{% endif %}

				<form method="post">
					{% csrf_token %}
					
					<div class="mb-3">
						<label for="id_username" class="form-label fw-bold" style="color: #1e40af;">اسم المستخدم *</label>
						<div class="input-group">
							<span class="input-group-text bg-light border-end-0">
								<i class="fas fa-user text-muted"></i>
							</span>
							<input type="text" class="form-control border-start-0" id="id_username" name="username" 
								   placeholder="أدخل اسم المستخدم" value="{{ form_data.username|default:'' }}" required>
						</div>
					</div>

					<div class="mb-3">
						<label for="id_national_id" class="form-label fw-bold" style="color: #1e40af;">الرقم القومي *</label>
						<div class="input-group">
							<span class="input-group-text bg-light border-end-0">
								<i class="fas fa-id-card text-muted"></i>
							</span>
							<input type="text" class="form-control border-start-0" id="id_national_id" name="national_id" 
								   placeholder="أدخل الرقم القومي (14 رقم)" value="{{ form_data.national_id|default:'' }}" 
								   pattern="[0-9]{14}" title="أدخل رقم قومي صحيح (14 رقم)" maxlength="14" required>
						</div>
						<div class="form-text">يجب أن يكون الرقم القومي مطابق للرقم المسجل في الحساب</div>
					</div>

					<div class="mb-3">
						<label for="id_phone" class="form-label fw-bold" style="color: #1e40af;">رقم الهاتف *</label>
						<div class="input-group">
							<span class="input-group-text bg-light border-end-0">
								<i class="fas fa-phone text-muted"></i>
							</span>
							<input type="tel" class="form-control border-start-0" id="id_phone" name="phone" 
								   placeholder="أدخل رقم الهاتف المسجل (مثال: 0123456789)" value="{{ form_data.phone|default:'' }}" 
								   pattern="[0-9]{10,11}" title="أدخل رقم هاتف صحيح من 10-11 رقم" required>
						</div>
						<div class="form-text">يجب أن يكون رقم الهاتف مطابق للرقم المسجل في الحساب</div>
					</div>

					<div class="mb-4">
						<label for="id_reason" class="form-label fw-bold" style="color: #1e40af;">سبب الطلب (اختياري)</label>
						<textarea class="form-control" id="id_reason" name="reason" rows="3" 
								  placeholder="اذكر سبب طلبك لاستعادة كلمة المرور (اختياري)">{{ form_data.reason|default:'' }}</textarea>
					</div>

					{% if errors %}
					<div class="alert alert-danger" role="alert">
						<i class="fas fa-exclamation-triangle me-2"></i>
						يرجى تصحيح الأخطاء التالية:
						<ul class="mb-0 mt-2">
							{% for error in errors %}
								<li>{{ error }}</li>
							{% endfor %}
						</ul>
					</div>
					{% endif %}

					<div class="alert alert-info" role="alert">
						<i class="fas fa-info-circle me-2"></i>
						<strong>ملاحظة:</strong> سيتم مراجعة طلبك من قبل الإدارة. قد يستغرق الأمر بعض الوقت للتحقق من بياناتك. 
						سيتم إعادة تعيين كلمة المرور بعد الموافقة على طلبك.
					</div>

					<div class="d-grid">
						<button type="submit" class="btn btn-warning btn-lg">
							<i class="fas fa-paper-plane me-2"></i>
							إرسال الطلب
						</button>
					</div>
				</form>

				<hr class="my-4">

				<div class="text-center">
					<p class="text-muted mb-2">تذكرت كلمة المرور؟</p>
					<a href="{% url 'login' %}" class="btn btn-outline-primary" style="border-color: #1e40af; color: #1e40af;">
						<i class="fas fa-sign-in-alt me-2"></i>
						تسجيل الدخول
					</a>
				</div>
			</div>
		</div>
	</div>
</div>
{% endblock %}

